<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>My First Post - MalBlog</title><meta name=Description content="This is my cool site"><meta property="og:title" content="My First Post"><meta property="og:description" content="Analyzed sample The sample used in this analysis is publicly available on tria.ge.
SHA256: 182d47c2c09fa29a48a46781da49a07967e1136708ba28e1acaca92858b05a16.
Link: https://tria.ge/220716-j58k1aaec4
Lab Setup The Lab used in this analysis is composed of a Windows machine and a Remnux host.
MarineGEO logo The default gateway on the windows machine is 192.168.234.129 Remnux has Inetsim, FakeDns and Wireshark configured and running. Remnux can intercept all incoming traffic. Static Analysis 1. Peframe Using Peframe, a non-common section name $u and few interesting API call have been identified."><meta property="og:type" content="article"><meta property="og:url" content="https://khoulouds.github.io/cyber-blog/posts/my-first-post/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-21T00:23:02+02:00"><meta property="article:modified_time" content="2022-10-21T00:23:02+02:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="My First Post"><meta name=twitter:description content="Analyzed sample The sample used in this analysis is publicly available on tria.ge.
SHA256: 182d47c2c09fa29a48a46781da49a07967e1136708ba28e1acaca92858b05a16.
Link: https://tria.ge/220716-j58k1aaec4
Lab Setup The Lab used in this analysis is composed of a Windows machine and a Remnux host.
MarineGEO logo The default gateway on the windows machine is 192.168.234.129 Remnux has Inetsim, FakeDns and Wireshark configured and running. Remnux can intercept all incoming traffic. Static Analysis 1. Peframe Using Peframe, a non-common section name $u and few interesting API call have been identified."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://khoulouds.github.io/cyber-blog/posts/my-first-post/><link rel=stylesheet href=/cyber-blog/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"My First Post","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/khoulouds.github.io\/cyber-blog\/posts\/my-first-post\/"},"genre":"posts","keywords":"Peframe, PeStudio, Ahmed","wordcount":502,"url":"https:\/\/khoulouds.github.io\/cyber-blog\/posts\/my-first-post\/","datePublished":"2022-10-21T00:23:02+02:00","dateModified":"2022-10-21T00:23:02+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"amka"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/cyber-blog/ title=MalBlog>Malblog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/cyber-blog/posts/>Posts </a><a class=menu-item href=/cyber-blog/tags/>Tags </a><a class=menu-item href=/cyber-blog/categories/>Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/cyber-blog/ title=MalBlog>Malblog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/cyber-blog/posts/ title>Posts</a><a class=menu-item href=/cyber-blog/tags/ title>Tags</a><a class=menu-item href=/cyber-blog/categories/ title>Categories</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">My First Post</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/cyber-blog/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>amka</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-10-21>2022-10-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;502 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#analyzed-sample>Analyzed sample</a></li><li><a href=#lab-setup>Lab Setup</a></li><li><a href=#static-analysis>Static Analysis</a><ul><li></li></ul></li><li><a href=#behavioral-analysis>Behavioral Analysis</a><ul><li></li></ul></li><li><a href=#dynamic-analysis>Dynamic Analysis</a></li><li><a href=#iocs>IOCs</a></li></ul></nav></div></div><div class=content id=content><h2 id=analyzed-sample>Analyzed sample</h2><p>The sample used in this analysis is publicly available on tria.ge.<br><em><strong>SHA256:</strong></em> 182d47c2c09fa29a48a46781da49a07967e1136708ba28e1acaca92858b05a16.<br><em><strong>Link:</strong></em> <a href=https://tria.ge/220716-j58k1aaec4 target=_blank rel="noopener noreffer">https://tria.ge/220716-j58k1aaec4</a></p><h2 id=lab-setup>Lab Setup</h2><p>The Lab used in this analysis is composed of a Windows machine and a Remnux host.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img1.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><blockquote><ul><li>The default gateway on the windows machine is 192.168.234.129</li><li>Remnux has Inetsim, FakeDns and Wireshark configured and running.</li><li>Remnux can intercept all incoming traffic.</li></ul></blockquote><h2 id=static-analysis>Static Analysis</h2><h4 id=1-peframe>1. Peframe</h4><p>Using Peframe, a non-common section name <em><strong>$u</strong></em> and few interesting API call have been
identified.<figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img2.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img3.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><h4 id=2-pestudio>2. PeStudio</h4><p>PeStudi was able to identify suspicious artifacts like the non-common, writable & executable
section <em><strong>$u</strong></em>.
The use of potentially suspicious Windows API functions and embedded file in section <em><strong>$u</strong></em>.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img4.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img5.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img6.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img7.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><h4 id=3-die>3. DIE</h4><p>Detect it easy, suggests that this malware is not packed.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img8.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><h2 id=behavioral-analysis>Behavioral Analysis</h2><h4 id=1-procdot-analysis>1. ProcDot analysis</h4><p>Below all the interactions done by the malware on the OS.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img9.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><blockquote><ul><li>Persistence method<br>The malware sets the following run key:
HKLM\System\CurrentControlSet\Services\bam\State\UserSettings\S-1-5-21-201960391-10506
06829-3220342080-1001\Device\HarddiskVolume3\Users\WindowsRM\Desktop\Samples\sampl
e_gw.exe</li></ul></blockquote><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img10.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><blockquote><ul><li>Dropper behavior<br>The analyzed specimen, drops an executable file on the system and launch it
Dropped filename: C:\411b3d06.exe</li></ul></blockquote><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img11.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>This matches the observation using Process Hacker.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img12.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>The dropped file, creates and sets a new bat file.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img13.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>In addition, the dropped exe file, tries to bypass all proxy settings on the infected machine.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img14.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>Another observed interesting behavior, is the creation of 5 executable files under the TEMP folder.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img15.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>The dropped speciem, infects all the executable files on the host.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img16.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><h4 id=2-network-traffic-analysis>2. Network traffic analysis</h4><p>Right after executing the malware, a DNS request for the domain 1.dnsnb8[.]net was observed.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img17.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>In wireshark, TCP connections towards the same domain on port 799 was observed. After
reconfiguring the TCP simulation on Inetsim to accept incoming traffic on port 799, wireshark
was able to catch HTTP requests to download .rar files.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img18.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>The malware was aiming to drop the following files:</p><p><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k1.rar</p><p><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k2.rar</p><p><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k3.rar</p><p><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k4.rar</p><p><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k5.rar</p><p>This was confirmed by Inetsim reports</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img19.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>Fiddler client on the windows host was able to catch the same HTTP traffic:</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img20.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>These 5 rar files could be linked to the 5 executables generated by the dropped specimen
<em><strong>C:\411b3d06.exe</strong></em></p><h2 id=dynamic-analysis>Dynamic Analysis</h2><p>During a brief analysis using x32gdb debugger, the behavior of the malware has been
confirmed. The created of the file with the name 411b3d06.exe has been observed at runtime.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img21.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>The specimen was observed checking its original filename and compare it to Remove.
If the file is called Remove.exe, the malware will display a message box to the user saying:
“This program is normally started by windows”. If not, the program will just display “Setup
program invalid or damaged”.</p><p><figure><a class=lightgallery href=https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png title="MarineGEO circle logo" data-thumbnail=https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png data-sub-html="<h2>MarineGEO logo</h2><p>MarineGEO circle logo</p>"><img class=lazyload src=/cyber-blog/svg/loading.min.svg data-src=https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png data-srcset="https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png, https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png 1.5x, https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png 2x" data-sizes=auto alt=https://raw.githubusercontent.com/khouloudS/blogs/main/img22.png></a><figcaption class=image-caption>MarineGEO logo</figcaption></figure></p><p>The filename has no impact on the behavior of the malware.</p><h2 id=iocs>IOCs</h2><table><thead><tr><th style=text-align:left>Type</th><th style=text-align:left>Value</th></tr></thead><tbody><tr><td style=text-align:left>sha1</td><td style=text-align:left>2fac3856507d08bd8264d2bd858e8b0c91b873dc</td></tr><tr><td style=text-align:left>sha256</td><td style=text-align:left>182d47c2c09fa29a48a46781da49a07967e1136708ba28e1acaca92858b05a16</td></tr><tr><td style=text-align:left>imphash</td><td style=text-align:left>89AD82854409B9DD81837C899D65F03E</td></tr><tr><td style=text-align:left>Dropped files</td><td style=text-align:left>182d47c2c09fa29a48a46781da49a07967e1136708ba28e1acaca92858b05a16</td></tr><tr><td style=text-align:left>Domain</td><td style=text-align:left>1.dnsnb8[.]net</td></tr><tr><td style=text-align:left>HTTP connections</td><td style=text-align:left><a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k1.rar <a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k2.rar <a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k3.rar <a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k4.rar <a href=http://1.dnsnb target=_blank rel="noopener noreffer">http://1.dnsnb</a>8[.]net:799/cj/k5.rar</td></tr><tr><td style=text-align:left>User Agent</td><td style=text-align:left>Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/7.0; .NET4.0C; .NET4.0E)</td></tr></tbody></table></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-10-21</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/cyber-blog/posts/my-first-post/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/cyber-blog/tags/peframe/>Peframe</a>,&nbsp;<a href=/cyber-blog/tags/pestudio/>PeStudio</a>,&nbsp;<a href=/cyber-blog/tags/ahmed/>Ahmed</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/cyber-blog/>Home</a></span></section></div><div class=post-nav></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Amka</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/cyber-blog/ target=_blank>amka</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{algoliaAppID:"46EFAQRJLX",algoliaIndex:"",algoliaSearchKey:"fb5b8f112e67ae02bfa7c23d82f3464d",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/cyber-blog/js/theme.min.js></script></body></html>